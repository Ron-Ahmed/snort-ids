## leveraging App Detection to detect traffic to facebook.com
alert tcp any any -> any any ( msg:"Facebook Detected"; appids:"Facebook"; sid:10000010; metadata:policy security-ips alert; rev:1;)
alert icmp any any -> any any ( msg:"ICMP Traffic Detected"; sid:1000001; metadata:policy security-ips alert; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 22 (msg:"Inbound SSH traffic detected."; classtype:suspicious-login; sid: 1000002; rev:1;)
drop tcp $EXTERNAL_NET any -> $HOME_NET 23 (msg:"Inbound Telnet traffic detected."; classtype:suspicious-login; priority:1; sid:1000003; rev:1;)
reject tcp $EXTERNAL_NET any -> $HOME_NET 3389 (msg:"Inbound RDP traffic detected."; classtype:suspicious-login; sid:1000004; rev:1;)
reject tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"Attempted VSFTPD backdoor detected."; content:":)"; classtype:attempted-admin; sid:1000005; rev:1;)
alert udp $EXTERNAL_NET any -> $HOME_NET any (msg:"Linux Traceroute detected."; ttl:<3; classtype:network-scan; sid:1000006; rev:1;)
drop icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"Windows Traceroute detected"; ttl:<3;classtype:network-scan; sid:1000007; rev:1;)
drop icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"Large ICMP packet, possible DoS"; classtype:attempted-dos; dsize:1024<>65535; sid:10000008; rev:1;)
reject ftp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"FTP brute force detected"; classtype:unsuccessful-user; content:"USER"; detection_filter:track by_src, count 4, seconds 60; sid:10000011; rev:1;)



additional rules

alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"FTP exploit attempted"; protect_content:"HASHVALUE"; hash:sha256;sid:1000018; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"FTP exploit attempted"; content:"|3A 29|"; rawbytes; sid:1000018; rev:1;)
alert tcp any any -> $HOME_NET [80,8080] (msg:"SQL Injection Detected"; flow:established,to_server; http_uri; content:"/wordpress/wp-content/plugins/demo_vul/endpoint.php"; content:"union",distance 0; content:"select",distance 0,nocase; content:"from", distance 0; sid:123;)


